# .github/workflows/pull-image.yml
name: Pull Docker Hub image

on:
  workflow_dispatch:
    inputs:
      tag:
        description: "Docker tag to pull"
        required: true
        default: "latest"

jobs:
  pull:
    runs-on: ubuntu-latest
    steps:
      - name: Set image env
        run: echo "IMAGE=venki2pt/starbucks:${{ github.event.inputs.tag }}" >> $GITHUB_ENV

      # Uncomment if the repo is private
      - name: Docker login (private repos)
        if: ${{ secrets.DOCKERHUB_USERNAME && secrets.DOCKERHUB_TOKEN }}
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}

      - name: Check tag exists
        run: |
          if ! docker manifest inspect "$IMAGE" > /dev/null 2>&1; then
            echo "âŒ Tag not found on Docker Hub: $IMAGE"
            echo "ğŸ‘‰ Use one of the actual tags listed at:"
            echo "   https://hub.docker.com/r/venki2pt/starbucks/tags"
            exit 1
          fi

      - name: Pull image
        run: docker pull "$IMAGE"

      - name: Run a command in the image (example)
        run: docker run --rm "$IMAGE" echo "Image pulled OK"
